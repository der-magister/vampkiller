                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module player
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _p_engine_calcCoord
                                     11 	.globl _p_player_init
                                     12 	.globl _p_player_setSprite
                                     13 	.globl _v_player_kolision
                                     14 	.globl _p_player_move
                                     15 	.globl _p_player_attack
                                     16 ;--------------------------------------------------------
                                     17 ; special function registers
                                     18 ;--------------------------------------------------------
                                     19 	.area _HRAM
                                     20 ;--------------------------------------------------------
                                     21 ; ram data
                                     22 ;--------------------------------------------------------
                                     23 	.area _DATA
                                     24 ;--------------------------------------------------------
                                     25 ; ram data
                                     26 ;--------------------------------------------------------
                                     27 	.area _INITIALIZED
                                     28 ;--------------------------------------------------------
                                     29 ; absolute external ram data
                                     30 ;--------------------------------------------------------
                                     31 	.area _DABS (ABS)
                                     32 ;--------------------------------------------------------
                                     33 ; global & static initialisations
                                     34 ;--------------------------------------------------------
                                     35 	.area _HOME
                                     36 	.area _GSINIT
                                     37 	.area _GSFINAL
                                     38 	.area _GSINIT
                                     39 ;--------------------------------------------------------
                                     40 ; Home
                                     41 ;--------------------------------------------------------
                                     42 	.area _HOME
                                     43 ;player.c:27: void p_player_init (void) __nonbanked
                                     44 ;	---------------------------------
                                     45 ; Function p_player_init
                                     46 ; ---------------------------------
    00000000                         47 _p_player_init::
                                     48 ;player.c:30: v_slp = 3; v_skey = 0; v_sweih = 0; v_pflock = FALSE; 
    00000000 21r00r00         [12]   49 	ld	hl, #_v_slp
    00000003 36 03            [12]   50 	ld	(hl), #0x03
    00000005 AF               [ 4]   51 	xor	a, a
    00000006 EAr00r00         [16]   52 	ld	(#_v_skey), a
    00000009 EAr00r00         [16]   53 	ld	(#_v_sweih),a
    0000000C AF               [ 4]   54 	xor	a, a
    0000000D EAr00r00         [16]   55 	ld	(#_v_pflock),a
                                     56 ;player.c:31: v_sxk = 80; v_syk = 40; v_sri = UP;
    00000010 21r00r00         [12]   57 	ld	hl, #_v_sxk
    00000013 36 50            [12]   58 	ld	(hl), #0x50
    00000015 21r00r00         [12]   59 	ld	hl, #_v_syk
    00000018 36 28            [12]   60 	ld	(hl), #0x28
    0000001A 21r00r00         [12]   61 	ld	hl, #_v_sri
    0000001D 36 01            [12]   62 	ld	(hl), #0x01
                                     63 ;/opt/gbdk/include/gb/gb.h:1887: shadow_OAM[nb].tile=tile;
    0000001F 21r02r00         [12]   64 	ld	hl, #(_shadow_OAM + 2)
    00000022 36 00            [12]   65 	ld	(hl), #0x00
    00000024 21r06r00         [12]   66 	ld	hl, #(_shadow_OAM + 6)
    00000027 36 03            [12]   67 	ld	(hl), #0x03
                                     68 ;player.c:35: p_player_setSprite ();
                                     69 ;player.c:36: }
    00000029 C3r2Cr00         [16]   70 	jp	_p_player_setSprite
                                     71 ;player.c:39: void p_player_setSprite (void) __nonbanked
                                     72 ;	---------------------------------
                                     73 ; Function p_player_setSprite
                                     74 ; ---------------------------------
    0000002C                         75 _p_player_setSprite::
                                     76 ;player.c:41: move_sprite (0, v_sxk, v_syk);
    0000002C FAr00r00         [16]   77 	ld	a, (_v_syk)
    0000002F 47               [ 4]   78 	ld	b, a
    00000030 FAr00r00         [16]   79 	ld	a, (_v_sxk)
    00000033 4F               [ 4]   80 	ld	c, a
                                     81 ;/opt/gbdk/include/gb/gb.h:1973: OAM_item_t * itm = &shadow_OAM[nb];
    00000034 21r00r00         [12]   82 	ld	hl, #_shadow_OAM
                                     83 ;/opt/gbdk/include/gb/gb.h:1974: itm->y=y, itm->x=x;
    00000037 78               [ 4]   84 	ld	a, b
    00000038 22               [ 8]   85 	ld	(hl+), a
    00000039 71               [ 8]   86 	ld	(hl), c
                                     87 ;player.c:42: v_smk = p_engine_calcCoord (v_sxk, v_syk);
    0000003A FAr00r00         [16]   88 	ld	a, (_v_syk)
    0000003D 5F               [ 4]   89 	ld	e, a
    0000003E FAr00r00         [16]   90 	ld	a, (_v_sxk)
    00000041 CDr00r00         [24]   91 	call	_p_engine_calcCoord
    00000044 EAr00r00         [16]   92 	ld	(#_v_smk),a
                                     93 ;player.c:44: }
    00000047 C9               [16]   94 	ret
                                     95 ;player.c:47: uint8_t v_player_kolision (unsigned char l_tile) __nonbanked
                                     96 ;	---------------------------------
                                     97 ; Function v_player_kolision
                                     98 ; ---------------------------------
    00000048                         99 _v_player_kolision::
    00000048 4F               [ 4]  100 	ld	c, a
                                    101 ;player.c:51: for (l_i = 0; l_i != sizeof (v_kolidat) + 1; ++l_i) {
    00000049 16 00            [ 8]  102 	ld	d, #0x00
    0000004B                        103 00104$:
                                    104 ;player.c:52: if (l_tile == v_kolidat [l_i]) return FALSE;
    0000004B 3Er00            [ 8]  105 	ld	a, #<(_v_kolidat)
    0000004D 82               [ 4]  106 	add	a, d
    0000004E 6F               [ 4]  107 	ld	l, a
    0000004F 3Es00            [ 8]  108 	ld	a, #>(_v_kolidat)
    00000051 CE 00            [ 8]  109 	adc	a, #0x00
    00000053 67               [ 4]  110 	ld	h, a
    00000054 7E               [ 8]  111 	ld	a, (hl)
    00000055 91               [ 4]  112 	sub	a, c
    00000056 20 02            [12]  113 	jr	NZ, 00105$
    00000058 AF               [ 4]  114 	xor	a, a
    00000059 C9               [16]  115 	ret
    0000005A                        116 00105$:
                                    117 ;player.c:51: for (l_i = 0; l_i != sizeof (v_kolidat) + 1; ++l_i) {
    0000005A 14               [ 4]  118 	inc	d
    0000005B 7A               [ 4]  119 	ld	a, d
    0000005C D6 05            [ 8]  120 	sub	a, #0x05
    0000005E 20 EB            [12]  121 	jr	NZ, 00104$
                                    122 ;player.c:55: return TRUE;
    00000060 3E 01            [ 8]  123 	ld	a, #0x01
                                    124 ;player.c:56: }
    00000062 C9               [16]  125 	ret
                                    126 ;player.c:60: void p_player_move (uint8_t l_ri) __nonbanked
                                    127 ;	---------------------------------
                                    128 ; Function p_player_move
                                    129 ; ---------------------------------
    00000063                        130 _p_player_move::
    00000063 4F               [ 4]  131 	ld	c, a
                                    132 ;player.c:62: uint8_t l_walk = TRUE;
    00000064 06 01            [ 8]  133 	ld	b, #0x01
                                    134 ;player.c:70: l_walk = v_player_kolision (v_lvldat [v_smk - 18]);
    00000066 FAr00r00         [16]  135 	ld	a, (_v_smk)
    00000069 5F               [ 4]  136 	ld	e, a
    0000006A 16 00            [ 8]  137 	ld	d, #0x00
                                    138 ;player.c:65: if (l_ri == UP) {
    0000006C 79               [ 4]  139 	ld	a, c
    0000006D 3D               [ 4]  140 	dec	a
    0000006E 20 2D            [12]  141 	jr	NZ, 00126$
                                    142 ;player.c:67: v_sri = UP; 
    00000070 21r00r00         [12]  143 	ld	hl, #_v_sri
    00000073 36 01            [12]  144 	ld	(hl), #0x01
                                    145 ;player.c:69: if (v_syk > 24) {
    00000075 3E 18            [ 8]  146 	ld	a, #0x18
    00000077 21r00r00         [12]  147 	ld	hl, #_v_syk
    0000007A 96               [ 8]  148 	sub	a, (hl)
    0000007B D2r17r01         [16]  149 	jp	NC, 00127$
                                    150 ;player.c:70: l_walk = v_player_kolision (v_lvldat [v_smk - 18]);
    0000007E 7B               [ 4]  151 	ld	a, e
    0000007F C6 EE            [ 8]  152 	add	a, #0xee
    00000081 4F               [ 4]  153 	ld	c, a
    00000082 7A               [ 4]  154 	ld	a, d
    00000083 CE FF            [ 8]  155 	adc	a, #0xff
    00000085 47               [ 4]  156 	ld	b, a
    00000086 21r00r00         [12]  157 	ld	hl, #_v_lvldat
    00000089 09               [ 8]  158 	add	hl, bc
    0000008A 7E               [ 8]  159 	ld	a, (hl)
    0000008B CDr48r00         [24]  160 	call	_v_player_kolision
                                    161 ;player.c:72: if (l_walk == TRUE) v_syk -= 8;
    0000008E 47               [ 4]  162 	ld	b, a
    0000008F 3D               [ 4]  163 	dec	a
    00000090 C2r17r01         [16]  164 	jp	NZ, 00127$
    00000093 FAr00r00         [16]  165 	ld	a, (_v_syk)
    00000096 C6 F8            [ 8]  166 	add	a, #0xf8
    00000098 EAr00r00         [16]  167 	ld	(#_v_syk),a
    0000009B 18 7A            [12]  168 	jr	00127$
    0000009D                        169 00126$:
                                    170 ;player.c:76: else if (l_ri == DOWN) {
    0000009D 79               [ 4]  171 	ld	a, c
    0000009E D6 02            [ 8]  172 	sub	a, #0x02
    000000A0 20 26            [12]  173 	jr	NZ, 00123$
                                    174 ;player.c:78: v_sri = DOWN;
    000000A2 21r00r00         [12]  175 	ld	hl, #_v_sri
    000000A5 36 02            [12]  176 	ld	(hl), #0x02
                                    177 ;player.c:80: if (v_syk < 128) {
    000000A7 FAr00r00         [16]  178 	ld	a, (#_v_syk)
    000000AA D6 80            [ 8]  179 	sub	a, #0x80
    000000AC 30 69            [12]  180 	jr	NC, 00127$
                                    181 ;player.c:81: l_walk = v_player_kolision (v_lvldat [v_smk + 18]);
    000000AE 21 12 00         [12]  182 	ld	hl, #0x0012
    000000B1 19               [ 8]  183 	add	hl, de
    000000B2 11r00r00         [12]  184 	ld	de, #_v_lvldat
    000000B5 19               [ 8]  185 	add	hl, de
    000000B6 7E               [ 8]  186 	ld	a, (hl)
    000000B7 CDr48r00         [24]  187 	call	_v_player_kolision
                                    188 ;player.c:83: if (l_walk == TRUE) v_syk += 8;
    000000BA 47               [ 4]  189 	ld	b, a
    000000BB 3D               [ 4]  190 	dec	a
    000000BC 20 59            [12]  191 	jr	NZ, 00127$
    000000BE FAr00r00         [16]  192 	ld	a, (_v_syk)
    000000C1 C6 08            [ 8]  193 	add	a, #0x08
    000000C3 EAr00r00         [16]  194 	ld	(#_v_syk),a
    000000C6 18 4F            [12]  195 	jr	00127$
    000000C8                        196 00123$:
                                    197 ;player.c:87: else if (l_ri == LEFT) {
    000000C8 79               [ 4]  198 	ld	a, c
    000000C9 D6 03            [ 8]  199 	sub	a, #0x03
    000000CB 20 24            [12]  200 	jr	NZ, 00120$
                                    201 ;player.c:89: v_sri = LEFT;
    000000CD 21r00r00         [12]  202 	ld	hl, #_v_sri
    000000D0 36 03            [12]  203 	ld	(hl), #0x03
                                    204 ;player.c:91: if (v_sxk > 16) {
    000000D2 3E 10            [ 8]  205 	ld	a, #0x10
    000000D4 21r00r00         [12]  206 	ld	hl, #_v_sxk
    000000D7 96               [ 8]  207 	sub	a, (hl)
    000000D8 30 3D            [12]  208 	jr	NC, 00127$
                                    209 ;player.c:93: l_walk = v_player_kolision (v_lvldat [v_smk - 1]);
    000000DA 1B               [ 8]  210 	dec	de
    000000DB 21r00r00         [12]  211 	ld	hl, #_v_lvldat
    000000DE 19               [ 8]  212 	add	hl, de
    000000DF 7E               [ 8]  213 	ld	a, (hl)
    000000E0 CDr48r00         [24]  214 	call	_v_player_kolision
                                    215 ;player.c:95: if (l_walk == TRUE) v_sxk -= 8;
    000000E3 47               [ 4]  216 	ld	b, a
    000000E4 3D               [ 4]  217 	dec	a
    000000E5 20 30            [12]  218 	jr	NZ, 00127$
    000000E7 FAr00r00         [16]  219 	ld	a, (_v_sxk)
    000000EA C6 F8            [ 8]  220 	add	a, #0xf8
    000000EC EAr00r00         [16]  221 	ld	(#_v_sxk),a
    000000EF 18 26            [12]  222 	jr	00127$
    000000F1                        223 00120$:
                                    224 ;player.c:99: else if (l_ri == RIGHT) {
    000000F1 79               [ 4]  225 	ld	a, c
    000000F2 D6 04            [ 8]  226 	sub	a, #0x04
    000000F4 20 21            [12]  227 	jr	NZ, 00127$
                                    228 ;player.c:101: v_sri = RIGHT; 
    000000F6 21r00r00         [12]  229 	ld	hl, #_v_sri
    000000F9 36 04            [12]  230 	ld	(hl), #0x04
                                    231 ;player.c:103: if (v_sxk < 152) {
    000000FB FAr00r00         [16]  232 	ld	a, (#_v_sxk)
    000000FE D6 98            [ 8]  233 	sub	a, #0x98
    00000100 30 15            [12]  234 	jr	NC, 00127$
                                    235 ;player.c:104: l_walk = v_player_kolision (v_lvldat [v_smk + 1]);
    00000102 13               [ 8]  236 	inc	de
    00000103 21r00r00         [12]  237 	ld	hl, #_v_lvldat
    00000106 19               [ 8]  238 	add	hl, de
    00000107 7E               [ 8]  239 	ld	a, (hl)
    00000108 CDr48r00         [24]  240 	call	_v_player_kolision
                                    241 ;player.c:106: if (l_walk == TRUE) v_sxk += 8;
    0000010B 47               [ 4]  242 	ld	b, a
    0000010C 3D               [ 4]  243 	dec	a
    0000010D 20 08            [12]  244 	jr	NZ, 00127$
    0000010F FAr00r00         [16]  245 	ld	a, (_v_sxk)
    00000112 C6 08            [ 8]  246 	add	a, #0x08
    00000114 EAr00r00         [16]  247 	ld	(#_v_sxk),a
    00000117                        248 00127$:
                                    249 ;player.c:109: if (l_walk == TRUE) { p_player_setSprite (); }
    00000117 05               [ 4]  250 	dec	b
    00000118 CAr2Cr00         [16]  251 	jp	Z, _p_player_setSprite
                                    252 ;player.c:111: }
    0000011B C9               [16]  253 	ret
                                    254 ;player.c:114: void p_player_attack (void) __nonbanked
                                    255 ;	---------------------------------
                                    256 ; Function p_player_attack
                                    257 ; ---------------------------------
    0000011C                        258 _p_player_attack::
                                    259 ;player.c:116: if (v_pflock == TRUE) {
    0000011C FAr00r00         [16]  260 	ld	a, (#_v_pflock)
    0000011F 3D               [ 4]  261 	dec	a
    00000120 C0               [20]  262 	ret	NZ
                                    263 ;player.c:118: move_sprite (1, v_sxk, v_syk - 8);
    00000121 FAr00r00         [16]  264 	ld	a, (_v_syk)
    00000124 4F               [ 4]  265 	ld	c, a
    00000125 FAr00r00         [16]  266 	ld	a, (_v_sxk)
    00000128 5F               [ 4]  267 	ld	e, a
                                    268 ;player.c:117: if (v_sri == UP) {
    00000129 FAr00r00         [16]  269 	ld	a, (#_v_sri)
    0000012C 3D               [ 4]  270 	dec	a
    0000012D 20 0A            [12]  271 	jr	NZ, 00110$
                                    272 ;player.c:118: move_sprite (1, v_sxk, v_syk - 8);
    0000012F 79               [ 4]  273 	ld	a, c
    00000130 C6 F8            [ 8]  274 	add	a, #0xf8
                                    275 ;/opt/gbdk/include/gb/gb.h:1973: OAM_item_t * itm = &shadow_OAM[nb];
                                    276 ;/opt/gbdk/include/gb/gb.h:1974: itm->y=y, itm->x=x;
    00000132 21r04r00         [12]  277 	ld	hl, #(_shadow_OAM + 4)
    00000135 22               [ 8]  278 	ld	(hl+), a
    00000136 73               [ 8]  279 	ld	(hl), e
                                    280 ;player.c:118: move_sprite (1, v_sxk, v_syk - 8);
    00000137 18 3D            [12]  281 	jr	00111$
    00000139                        282 00110$:
                                    283 ;player.c:120: else if (v_sri == DOWN) {
    00000139 FAr00r00         [16]  284 	ld	a, (#_v_sri)
    0000013C D6 02            [ 8]  285 	sub	a, #0x02
    0000013E 20 0A            [12]  286 	jr	NZ, 00107$
                                    287 ;player.c:121: move_sprite (1, v_sxk, v_syk + 8);
    00000140 79               [ 4]  288 	ld	a, c
    00000141 C6 08            [ 8]  289 	add	a, #0x08
                                    290 ;/opt/gbdk/include/gb/gb.h:1973: OAM_item_t * itm = &shadow_OAM[nb];
                                    291 ;/opt/gbdk/include/gb/gb.h:1974: itm->y=y, itm->x=x;
    00000143 21r04r00         [12]  292 	ld	hl, #(_shadow_OAM + 4)
    00000146 22               [ 8]  293 	ld	(hl+), a
    00000147 73               [ 8]  294 	ld	(hl), e
                                    295 ;player.c:121: move_sprite (1, v_sxk, v_syk + 8);
    00000148 18 2C            [12]  296 	jr	00111$
    0000014A                        297 00107$:
                                    298 ;player.c:124: move_sprite (1, v_sxk - 8, v_syk);
    0000014A FAr00r00         [16]  299 	ld	a, (_v_syk)
    0000014D 4F               [ 4]  300 	ld	c, a
    0000014E FAr00r00         [16]  301 	ld	a, (_v_sxk)
    00000151 5F               [ 4]  302 	ld	e, a
                                    303 ;player.c:123: else if (v_sri == LEFT) {
    00000152 FAr00r00         [16]  304 	ld	a, (#_v_sri)
    00000155 D6 03            [ 8]  305 	sub	a, #0x03
    00000157 20 0C            [12]  306 	jr	NZ, 00104$
                                    307 ;player.c:124: move_sprite (1, v_sxk - 8, v_syk);
    00000159 7B               [ 4]  308 	ld	a, e
    0000015A C6 F8            [ 8]  309 	add	a, #0xf8
    0000015C 5F               [ 4]  310 	ld	e, a
                                    311 ;/opt/gbdk/include/gb/gb.h:1973: OAM_item_t * itm = &shadow_OAM[nb];
    0000015D 21r04r00         [12]  312 	ld	hl, #(_shadow_OAM + 4)
                                    313 ;/opt/gbdk/include/gb/gb.h:1974: itm->y=y, itm->x=x;
    00000160 79               [ 4]  314 	ld	a, c
    00000161 22               [ 8]  315 	ld	(hl+), a
    00000162 73               [ 8]  316 	ld	(hl), e
                                    317 ;player.c:124: move_sprite (1, v_sxk - 8, v_syk);
    00000163 18 11            [12]  318 	jr	00111$
    00000165                        319 00104$:
                                    320 ;player.c:126: else if (v_sri == RIGHT) {
    00000165 FAr00r00         [16]  321 	ld	a, (#_v_sri)
    00000168 D6 04            [ 8]  322 	sub	a, #0x04
    0000016A 20 0A            [12]  323 	jr	NZ, 00111$
                                    324 ;player.c:127: move_sprite (1, v_sxk + 8, v_syk);
    0000016C 7B               [ 4]  325 	ld	a, e
    0000016D C6 08            [ 8]  326 	add	a, #0x08
    0000016F 5F               [ 4]  327 	ld	e, a
                                    328 ;/opt/gbdk/include/gb/gb.h:1973: OAM_item_t * itm = &shadow_OAM[nb];
    00000170 21r04r00         [12]  329 	ld	hl, #(_shadow_OAM + 4)
                                    330 ;/opt/gbdk/include/gb/gb.h:1974: itm->y=y, itm->x=x;
    00000173 79               [ 4]  331 	ld	a, c
    00000174 22               [ 8]  332 	ld	(hl+), a
    00000175 73               [ 8]  333 	ld	(hl), e
                                    334 ;player.c:127: move_sprite (1, v_sxk + 8, v_syk);
    00000176                        335 00111$:
                                    336 ;player.c:129: v_angriff = TRUE; v_action = FALSE; v_angriffstimer = 0;
    00000176 21r00r00         [12]  337 	ld	hl, #_v_angriff
    00000179 36 01            [12]  338 	ld	(hl), #0x01
    0000017B AF               [ 4]  339 	xor	a, a
    0000017C EAr00r00         [16]  340 	ld	(#_v_action), a
    0000017F EAr00r00         [16]  341 	ld	(#_v_angriffstimer),a
                                    342 ;player.c:131: }
    00000182 C9               [16]  343 	ret
                                    344 	.area _HOME
                                    345 ;--------------------------------------------------------
                                    346 ; code
                                    347 ;--------------------------------------------------------
                                    348 	.area _CODE
                                    349 	.area _CODE
                                    350 	.area _INITIALIZER
                                    351 	.area _CABS (ABS)
